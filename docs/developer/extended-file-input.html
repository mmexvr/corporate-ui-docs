<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta charset="utf-8">
  <noscript><meta http-equiv="refresh" content="0;url=https://static.scania.com/vendors/components/pure-js/nonJS-browsers/1.0.0/nonJS-browsers.html"></noscript>

  <title>UX Library - Scania Custom File Upload</title>
  <script src="https://static.scania.com/vendors/components/pure-js/browser-reject/1.0.0/js/browser-reject.js"></script>

  <!-- Table Sorter Plugin -->
  <script src="https://static.scania.com/vendors/frameworks/jQuery/1.11.3/jquery-1.11.3.min.js"></script>

  <script src="https://static.scania.com/build/global/3.5.2/js/corporate-ui.js?monitoring=true"></script>
  <link rel="stylesheet" href="css/scania-bootstrap-docs.css">
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-113165423-1"></script>
  <script src="/corporate-ui-docs/js/google-analytics.js"></script>
  <link rel="import" href="https://static.scania.com/build/global/3.5.2/components/file-upload/file-upload.html">

  <script src="https://www.gstatic.com/firebasejs/5.5.5/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyD_FLcBQQq4py2B7lfkckW3jv-Bf3wJ_O4",
      authDomain: "file-upload-test-3ce1d.firebaseapp.com",
      databaseURL: "https://file-upload-test-3ce1d.firebaseio.com",
      projectId: "file-upload-test-3ce1d",
      storageBucket: "file-upload-test-3ce1d.appspot.com",
      messagingSenderId: "213781398366"
    };
    firebase.initializeApp(config);
  </script>

</head>

<body class="scania app">
  <c-corporate-header site-name="UX Library" site-url="/corporate-ui-docs/">
    <nav-item location="/corporate-ui-docs/developer/support.html">Support</nav-item>
    <nav-item location="https://github.com/scania/corporate-ui">GitHub</nav-item>
  </c-corporate-header>

  <c-main-content>

    <c-main-navigation>
      <primary-items>
        <nav-item location="/corporate-ui-docs/">Home</nav-item>
        <nav-item location="/corporate-ui-docs/styleguide/">Style Guide
          <sub-navigation caption="Style Guide">
            <nav-item location="/corporate-ui-docs/logotype/">Logotype</nav-item>
            <nav-item location="/corporate-ui-docs/icons/">Icons</nav-item>
            <nav-item location="/corporate-ui-docs/colours/">Colours</nav-item>
            <nav-item location="/corporate-ui-docs/typography/">Typography</nav-item>
          </sub-navigation>
        </nav-item>
        <nav-item location="/corporate-ui-docs/developer/bootstrap-original-docs.html" class="active">Web Applications
          <sub-navigation caption="Scania Bootstrap">
            <nav-item location="/corporate-ui-docs/developer/bootstrap-original-docs.html">Bootstrap Documentation</nav-item>
            <nav-item location="/corporate-ui-docs/template/html-copy-paste/html-copy-paste.html">HTML Copy Paste</nav-item>
          </sub-navigation>
        </nav-item>
        <nav-item location="/corporate-ui-docs/mobile-apps/">Mobile Apps</nav-item>
        <nav-item location="https://github.com/scania/corporate-ui/issues">Report an Issue</nav-item>
        <nav-item location="/corporate-ui-docs/developer/support.html">Support</nav-item>
      </primary-items>
    </c-main-navigation>

    <section class="light">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <h1>Scania Custom File Upload</h1>

              <h3 id="file-upload-input">File upload input</h3>
                  <p>This is a component for uploading single or multiple files with drag and drop support.</p>
                  <p>To use this component, put a tag <code>&lt;c-file-upload&gt;&lt;/c-file-upload&gt;</code> in a page.</p>
                  <h4 id="properties">Properties</h4>
                  <p>Change the value of the following properties to have different options.</p>
                  <ul>
                    <li><code>name</code> : String<ul>
                      <li>This property will set the name of the upload file input component.</li>
                    </ul>
                  </li>
                  <li><code>multiple</code> : Boolean<ul>
                    <li>Add <code>multiple</code> property to enable multiple files selection.</li>
                  </ul>
                </li>
                <li><code>max-file-size</code> : Number (in KB)<ul>
                  <li>This property will set maximum file size. The value should be any number in Kilobytes.</li>
                </ul>
              </li>
              <li><code>accept</code> : String<ul>
                <li>Set the accepted MIME type or file extension to limit acceptable file types. If this property is not set, the file upload will receive any file types.</li>
              </ul>
            </li>
            <li><code>display</code> : String<ul>
              <li>Set to <code>display : 'inline'</code> to switch to compact inline style.</li>
            </ul>
          </li>
          </ul>
          <p>On the example below, the component will have capabilities to select multiple files, only files with .jpg and .pdf extension are accepted, and the maximum file size is 1000KB.</p>
          <p><code>&lt;c-file-upload name="uxlib-file-input" multiple max-file-size=1000 accept=".jpg, .pdf"&gt;&lt;/c-file-upload&gt;</code></p>
          <p>On the example below, the component will have capabilities to select only one file, only image file is accepted, and the maximum file size is 1000KB.</p>
          <p><code>&lt;c-file-upload name="uxlib-file-input" max-file-size=1000 accept="image/*, application/pdf"&gt;&lt;/c-file-upload&gt;</code></p>
          <h4 id="event">Event</h4>
          <ul>
            <li><code>uploadFiles</code> : CustomEvent. Fired when upload button inside the component is pressed.</li>
          </ul>
          <h4 id="method">Method</h4>
          <ul>
            <li><code>setProgressBarValue(file, progress)</code> . Triggers visual cues for upload progress such as progress bar and loading spinner.</li>
          </ul>
          <h3 id="developer-tutorial">Developer Info</h3>
          <p>You need to call the API to upload the files to your own server.</p>
          <p>There are 2 things you need to do in your application.</p>
          <ul>
            <li>Add event listener to the <code>uploadFiles</code> event to have upload function works in your application setting.
              <h5>Example:</h5>
              <code>document.addEventListener('uploadFiles',Upload, false);</code>
            Then you can write your own upload function inside 'Upload'</li>
          </ul>
          <pre><code class="lang-javascript">
  function Upload(event){
    var files = event.detail.files;
    // put your own upload function
  }
        </code></pre>
        <ul>
          <li>To make the progress bar works, retrieve the file upload component object via <code>document.querySelector</code>.</li>
        </ul>
        <p>Then set the progress bar value for each file inside with <code>setProgressBarValue(file, progress)</code> function.
          Set the progress value with the percentage that you get from the server response. <a href="https://www.sitepoint.com/tracking-upload-progress-with-php-and-javascript/">See example here</a></p>
          <h5>Example:</h5>
          <h4 id="display-inline">Example on how to use API:</h4>
          <pre><code class="lang-javascript">
  var fileUploadComp = document.querySelector('c-file-upload');
  document.addEventListener('uploadFiles',Upload, false);

  function Upload(event){
      var files = event.detail.files;
      for(var i=0; i&lt;files.length; i++){
      uploadSingleFile(files[i]);
    }
  }

  function uploadSingleFile(file){
    // ...

    fileUploadComp.setProgressBarValue(file,progress);
      // ...
  }
    </code></pre>


    <div id="demotemplate" class="demo-template">
      <h4 id="display-inline">File upload with drop area</h4>
      <c-file-upload name="upload1" multiple="" max-file-size="1000" accept="image/*"></c-file-upload>

<h5>Code <i class="icon-chevron-sign-up"></i></h5>
<pre class="style-scope demo-component" style=""><code class="style-scope demo-component">
&lt;link rel="import" href="https://static.scania.com/build/global/3.5.0/components/file-upload/file-upload.html"&gt;

&lt;c-file-upload name="upload1" multiple max-file-size=1000 accept="image/*"&gt;&lt;/c-file-upload&gt;

</code></pre>

        <h4 id="display-inline">Compact inline style</h4>
        <c-file-upload name="upload2" multiple max-file-size=1000 accept="image/*, application/pdf" required display="inline"></c-file-upload>

        <h5>Code <i class="icon-chevron-sign-up"></i></h5>
        <pre class="style-scope demo-component" style=""><code class="style-scope demo-component">
        &lt;link rel="import" href="https://static.scania.com/build/global/3.5.0/components/file-upload/file-upload.html"&gt;

        &lt;c-file-upload name="upload2" multiple max-file-size=1000 accept="image/*" display="inline"&gt;&lt;/c-file-upload&gt;

        </code></pre>

        <h4 id="file-extension-icon">File extension icon</h4>

        <file-icon filename="Image.jpg"></file-icon>

        <h5>Code <i class="icon-chevron-sign-up"></i></h5>

<pre class="style-scope demo-component" style=""><code class="style-scope demo-component">
&lt;link rel="import" href="https://static.scania.com/build/global/3.5.2/components/file-upload/file-upload.html"&gt;
  &lt;file-icon filename="Image.jpg"&gt;
&lt;/file-icon&gt;

</code></pre>


          </div>
        </div>
      </div>
    </section>
    <c-corporate-footer></c-corporate-footer>

    <style>
    c-file-upload .action-btn-wrapper.c-file-upload,
    c-file-upload #dropArea.c-file-upload {
    border-radius: 0;
    -webkit-border-radius: 0;
    }

    c-file-upload .upload-file-wrapper.c-file-upload,
    c-file-upload .action-btn-wrapper.c-file-upload {
    box-shadow: none;
    }

    c-file-upload .action-btn-wrapper.c-file-upload {
        border: none;
    }

    </style>

    <script type="text/javascript">

      // ACCESS THE COMPONENT TO HANDLE PROGRESS BAR
      var fileUploadComp = document.querySelector('c-file-upload[name="upload1"]');
      var fileUploadComp2 = document.querySelector('c-file-upload[name="upload2"]');
      // ADD EVENT LISTENER TO HAVE UPLOAD FUNCTION WORKS IN YOUR APPLICATION SETTING
      document.addEventListener('uploadFiles',Upload, false);

      function Upload(event){
        for(var i=0; i<event.detail.files.length; i++){
          console.log(event.detail);
          uploadSingleFile(event.detail.files[i],event.detail.name);
        }
      }

      function uploadSingleFile(file,name){
        var ref = firebase.storage().ref();
        const filename = file.name;
        const metadata = {contentType: file.type};

        const task = ref.child(filename).put(file,metadata);

        task
          .on('state_changed', function(snapshot){
            var progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
            // SET PROGRESS BAR VALUE HERE DEPENDS ON YOUR OWN APPLICATION SETTING
            if(name=='upload1'){fileUploadComp.setProgressBarValue(file,progress);}
            else {fileUploadComp2.setProgressBarValue(file,progress);}

          });
        task.then(function(snapshot){
          var url = snapshot.ref.getDownloadURL();
          console.log(url);
        });

      }
    </script>

  </body>
</html>
